<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="//stuff.poteland.com/css/stuff.css">
        <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
        <script src="//stuff.poteland.com/js/react.min.js"></script>
        <script src="//stuff.poteland.com/js/JSXTransformer.js"></script>
    </head>
    <body>
      <header>
        <span class="logo">
          <a href="http://poteland.com"><img src="//stuff.poteland.com/avatars/redmage.jpeg"/></a>
        </span>

        <ul class="controls">
          <li>Size: __FILESIZE__</li>
          <li><a id="direct-link" href="__PATH__"><i class="fa fa-link"></i></a></li>
          <li><a id="torrent" href="__PATH__?torrent"><i class="fa fa-share-alt"></i></a></li>
          <li><a id="magnet" href=""><i class="fa fa-magnet"></i></a></li>
        </ul>
      </header>

      <section id="rich-preview">
      </section>
    </body>

    <script type="text/jsx">
      var dropName = document.querySelector("#direct-link").href

      // Render Images

      var imageFormats = [
        'png',
        'jpg',
      ]

      var ImagePreview = React.createClass({
        render: function() {
          return(
            <img className="preview" src={this.props.path} alt="You look wonderful today!"/>
          );
        }
      });

      imageFormats.forEach(function(format) {
        if (dropName.match(new RegExp(format + "$", "i"))) {
          React.render(
            <ImagePreview path="__PATH__"/>,
            document.getElementById('rich-preview')
          );
        }
      });


      // Render Audio

      var audioFormats = {
        mp3: 'audio/mpeg',
        ogg: 'audio/ogg',
        wav: 'audio/wav'
      }

      var AudioPreview = React.createClass({
        render: function() {
          return(
            <audio controls>
              <source className="preview" src={this.props.path} mime={this.props.mime}/>
              Your browser is unable to play this type of file, you can still download it though! :)
            </audio>
          );
        }
      });

      Object.keys(audioFormats).forEach(function(format) {
        if (dropName.match(new RegExp(format + "$", "i"))) {
          React.render(
            <AudioPreview path="__PATH__" mime={audioFormats[format]} />,
            document.getElementById('rich-preview')
          );
        }
      });


      // Render Video

      var videoFormats = {
        mov:  'video/mp4',
        mp4:  'video/mp4',
        webm: 'video/webm',
        ogg: 'video/ogg',
      }

      var VideoPreview = React.createClass({
        render: function() {
          return(
            <video controls>
              <source className="preview" src={this.props.path} mime={this.props.mime}/>
              Your browser is unable to play this type of file, you can still download it though! :)
            </video>
          );
        }
      });

      Object.keys(videoFormats).forEach(function(format) {
        if (dropName.match(new RegExp(format + "$", "i"))) {
          React.render(
            <VideoPreview path="__PATH__" mime={audioFormats[format]} />,
            document.getElementById('rich-preview')
          );
        }
      });
    </script>
</html>
